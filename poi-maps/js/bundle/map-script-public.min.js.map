{"version":3,"sources":["../map-script-public.js"],"names":["jQuery","document","ready","$","terrain","L","tileLayer","attribution","id","ext","map","Map","center","LatLng","zoom","layers","district_boundary","geoJson","addTo","getMarkers","categories","getCategories","post","miksei","ajaxurl","data","markers","JSON","parse","addMarkers","fail","response","console","log","responseText","statusText","categoryAttribute","attr","length","baseMaps","overlayMaps","markerLabels","Object","keys","forEach","markerArray","markerLabel","icon","markerObject","iconUrl","iconSize","push","marker","latLng","lat","lng","bindPopup","title","address","content","layerGroup","control","ajax","dataType","url","success","features","each","key","addData","error"],"mappings":"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","file":"map-script-public.min.js","sourcesContent":["\njQuery(document).ready(function ($) {\n  var terrain = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.{ext}', {\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\n    id: 'leafletMap',\n    ext: 'png'\n  });\n\n  var map = new L.Map(\"leafletMap\", {\n    center: new L.LatLng(61.6914766, 27.259305),\n    zoom: 11,\n    layers: [terrain]\n  });\n\n  var district_boundary = new L.geoJson();\n  district_boundary.addTo(map);\n\n  getMarkers();\n\n  function getMarkers () {\n    const categories = getCategories();\n\n    $.post(miksei.ajaxurl, {\n      'action': 'markers',\n      'data': { categories: categories }\n    }, (data) => {\n      const markers = JSON.parse(data);\n      addMarkers(markers);\n    }).fail((response) => {\n      console.log(response.responseText || response.statusText || 'Unknown error occurred');\n    });\n  }\n\n  function getCategories () {\n    const categoryAttribute = $('#mapCategories').attr('data-categories');\n    \n    if (categoryAttribute) {\n      const categories = JSON.parse(categoryAttribute);\n      console.log(categories);\n      if (categories && categories.length > 0) {\n        return categories;\n      }\n    }\n    \n    return null;\n  }\n\n  function addMarkers (markers) {\n    var baseMaps = {};\n    var overlayMaps = {};\n    const markerLabels = Object.keys(markers);\n\n    baseMaps['Terrain'] = terrain;\n\n    markerLabels.forEach(markerLabel => {\n      let markerArray = [];\n      \n      markers[markerLabel].forEach(markerObject => {\n        let icon = null;\n        if (markerObject.icon) {\n          icon = L.icon({\n            iconUrl: markerObject.icon,\n            iconSize:     [40, 40]\n          });\n        }\n\n        markerArray.push(L.marker([markerObject.latLng.lat, markerObject.latLng.lng], {icon: icon}).bindPopup('<h4>'+markerObject.title+'</h4><small>'+markerObject.address+'</small>' + '<p>'+markerObject.content+'</p>'));\n      });\n      overlayMaps[markerLabel] = L.layerGroup(markerArray).addTo(map);\n    });\n\n    L.control.layers(baseMaps, overlayMaps).addTo(map);\n  }\n\n  $.ajax({\n  dataType: \"json\",\n  url: \"https://gist.githubusercontent.com/VilleKoivukangas/77b78e6925b336744790e74c4578309c/raw/2d46daec1a99b88f8d2f2e11d27fc824968e05c4/powerline.json\",\n  success: function(data) {\n    $(data.features).each(function(key, data) {\n      district_boundary.addData(data);\n    });\n  }\n  }).error(function() {\n    console.error(\"Failed to get powerlines geoJSON\");\n  });\n\n});"]}